<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="../Icons/Logo(Purple).png">
    <title>UI/UX Designer (LJPS)</title>
    <link rel="stylesheet" href="../CSS/Role_Specific.css">
    <link href='https://fonts.googleapis.com/css?family=Inter:600,400,550,500' rel='stylesheet'>

    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">

    <!--Axios-->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <!--Sweetalert2-->
    <link href="//cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma/bulma.css" rel="stylesheet">
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.js"></script>

</head>
<body>
    
    <!--Header-->    
    <div id='header'></div>
    
     <!-- Role Description-->
    <div id="roledescription"></div>

      <!-- Key Task-->
    <div id="keytask"></div>


     <!-- Skills & Courses Header-->
    <div class="RoleInfo" style="margin-top:41px; height: 110px;">
        <div>
            <img src="../Icons/skillsandcourses.png" style="display: inline-block; width: 31px; height: 31px; margin-bottom: 12px; margin-right: 15px;">
            <h1 style="display: inline-block; font-family: Inter; font-weight: 550; font-size: 25px;">Skills & Courses</h1>
        </div>
    </div>

    <!-- Skills-->
     <div id="skills"></div>
    

   <script>
        
        /*Function to populate skills*/
        function populateSkills() {
        var url = "../db/getSkills.php"

        axios.get(url).
        then(response => {
            console.log(response.data)

            const skill_course_pairs = new Object()
            let all_course_pairs = []
            let unique_skills = []
            let all_skills = response.data
            let unique_skill_id = []
            for (let i = 0; i < all_skills.length; i++){
                if (!unique_skill_id.includes(all_skills[i].Skill_ID)){
                    unique_skill_id.push(all_skills[i].Skill_ID)
                }
            }
            console.log(unique_skill_id)

            for (let i = 0; i < unique_skill_id.length; i++){
                for (let j = 0; j < all_skills.length; j++){
                    if (unique_skill_id[i] == all_skills[j].Skill_ID){
                        unique_skills.push(all_skills[j])
                        break
                    }
                }
            }
            console.log(unique_skills)


            for (let i = 0; i < unique_skills.length; i++){

                let indiv_skill_html =                     
                    `<div class="RoleInfo" style="margin-top:41px; padding: 0px 0px 0px 0px">
                        <div class="row">
                            <div class="col">
                                <img src=${unique_skills[i].Skill_img} style="width: 497px; height: 408px; border-radius: 5px">
                            </div>
                            <div class="col" style="margin:auto">
                                <div class="card-body">
                                    <div class="card-text" id=${unique_skills[i].Skill_ID}>
                                        <h1 style="font-family: Inter; font-weight: 550; font-size: 25px;">${unique_skills[i].Skill_Name}</h1>
                                        <p style="display: inline-block; font-family: Inter; font-weight: 500;">Type of Skills: &nbsp;</p><p style="display: inline-block;">${unique_skills[i].Type_of_Skills}</p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                        <p style="display: inline-block; font-family: Inter; font-weight: 500;">Competency level: &nbsp;</p><p style="display: inline-block;">${unique_skills[i].Level_of_Competencies}</p><br><br>
                                        <h1 style="font-family: Inter; font-weight: 550; font-size: 20px;">Courses</h1>`
                    
                document.getElementById("skills").innerHTML += indiv_skill_html
            }

            for (let i = 0; i < unique_skill_id.length; i++){
                let course_pairs = []
                
                for (let j = 0; j < all_skills.length; j++){
                    if (unique_skill_id[i] == all_skills[j].Skill_ID){
                        course_pairs.push(all_skills[j].Course_ID)
                    }
                }
                
                all_course_pairs.push(course_pairs)
            }

            console.log(all_course_pairs)


            for (let i = 0; i < unique_skill_id.length; i++){
                for (let j = 0; j < all_course_pairs[i].length; j++){
                        let indv_course_html =    
                           `<div id=${all_course_pairs[i][j]} class="form-check courses" style="display:inline-block; margin-top: 20px">
                                <input class="form-check-input" type="checkbox" value=${all_course_pairs[i][j]} id=${all_course_pairs[i][j]}name>
                                <label class="form-check-label" for=${all_course_pairs[i][j]}name>
                                User Experience Design 
                                </label>
                                                              
                                <button id=${all_course_pairs[i][j]}info type="button" style="background-color: Transparent; border: none">
                                <img src= "../Icons/MoreInfo.png"  data-bs-target="#staticBackdrop">
                                </button>
                                   
                            </div> 
                        
`
                        document.getElementById(unique_skill_id[i]).innerHTML += indv_course_html 
                        document.getElementById(unique_skill_id[i]).innerHTML += `</div></div></div></div></div>`                
                }
            }
        })
        .catch(error => {
            console.log(error.message)
        })
        }


        /*Function to populate courses*/
        function getCourseData() {
        var url = "../db/getCourses.php"

        axios.get(url).
        then(response => {
            console.log(response.data)

            let all_courses = response.data
            let all_course_ids = []
            let displayed_courses = []
            let valid_courses = []


            for (let i = 0; i < all_courses.length; i++){

                if (!document.body.contains(document.getElementById(all_courses[i].Course_ID))){
                    continue
                }
                else{
                    document.getElementById(all_courses[i].Course_ID).getElementsByTagName("label")[0].innerText = all_courses[i].Course_Name
                }
                
            }


            for (let i = 0; i < document.getElementsByClassName("courses").length; i++){
                displayed_courses.push(document.getElementsByClassName("courses")[i].id)
            }

            for (let i = 0; i < all_courses.length; i++){
                all_course_ids.push(all_courses[i].Course_ID)
            }

            
            for (let i = 0; i < displayed_courses.length; i++){
                if (!all_course_ids.includes(displayed_courses[i])){
                    document.getElementById(displayed_courses[i]).remove()
                }
            }

            console.log(document.getElementsByClassName("courses"))

            for (let i = 0; i < document.getElementsByClassName("courses").length; i++){
                valid_courses.push(document.getElementsByClassName("courses")[i].id)
            }

            console.log(valid_courses)

            for (let i = 0; i < all_courses.length; i++){
                if (!valid_courses.includes(all_courses[i].Course_ID)){
                    all_courses.splice(i,1)
                }
            }
            

            for (let i = 0; i < all_courses.length; i++){
                document.getElementById(all_courses[i].Course_ID + "info").addEventListener("click", function(){
                    Swal.fire({
                        title: '<div style="text-align: left"><span style="color: #6A79F3;">' + all_courses[i].Course_Name + '</span></div>',
                        html: ` <div style='text-align: left'>
                                <div style="color: #000000; display: inline-block"><span style="font-family: Inter; font-weight: 500; color: #000000;"> Course_Type: &nbsp</span>`+ all_courses[i].Course_Type + `</div>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp
                                <div style="color: #000000; display: inline-block"><span style="font-family: Inter; font-weight: 500; color: #000000;"> Course_Category: &nbsp </span>`+ all_courses[i].Course_Category + `</div> <br><br>
                                <div style="overflow-x: hidden;word-wrap:break-word; color: #000000"> <span style="font-family: Inter; font-weight: 500; color: #000000"> Course Description: </span>`+ all_courses[i].Course_Desc + `</div></div></div>`,
                        width: '40rem',
                        focusConfirm: true,
                        confirmButtonText: 'I understand now!',
                        confirmButtonColor: '#6A79F3',
                        cancelButtonColor: '#d33',
                    })
                })
            }
            
        })
        .catch(error => {
            console.log(error.message)
        })
        }

        
        /* Functuon to populate role*/
        function populateRole() {
        var url = "../db/getAllRoles.php"

        axios.get(url).
        then(response => {
            let roledescription = response.data[2]['LJRole_Description']
            let roledescription_html =  
            `
            <div class="RoleInfo" style="margin-top: 20px">
                <div style="margin-bottom: 10px;">
                    <img src="../Icons/Role Description.png" style="display: inline-block; width: 31px; height: 31px; margin-bottom: 15px; margin-right: 15px;">
                    <h1 style="display: inline-block; font-family: Inter; font-weight: 550; font-size: 25px;">Role Description</h1>
                </div>
                <p>
                   ${roledescription}
                </p>
            </div>
                    
            `      

            document.getElementById("roledescription").innerHTML += roledescription_html

        })
        .catch(error => {
            console.log(error.message)
        })

        }


        /* Functuon to populate role*/
        function populateTask(){
        var url = "../db/getAllRoles.php"
        
        axios.get(url).
        then(response => {
            console.log(response.data)
            let keytask = response.data[2]['Key_Task']
            new_array = []
            string_concatenation = ""
            for (i=0; i < keytask.length; i++){
                if (parseInt(keytask[i]) && i != 0 ) {
                    new_array.push(string_concatenation)
                    string_concatenation = ""
                    string_concatenation += keytask[i]
                } else if(i === keytask.length-1) {
                    string_concatenation += keytask[i]
                    new_array.push(string_concatenation)
                } else { 
                    string_concatenation += keytask[i]
                }
            }
            console.log(new_array)
            
            let keytask_html =  
            `
            <div class="RoleInfo" style="margin-top:41px;">
            <div style="margin-bottom: 10px;">
            <img src="../Icons/Keytask.png" style="display: inline-block; width: 31px; height: 31px; margin-bottom: 12px; margin-right: 15px;">
            <h1 style="display: inline-block; font-family: Inter; font-weight: 550; font-size: 25px;">Key Tasks</h1>
            </div>`

            
            for (i=0; i < new_array.length; i++){
                if(i == new_array.length - 1 ){
                    keytask_html += `${new_array[i]}`
                } else {
                    keytask_html += `${new_array[i]}<br/>`
                }
            }
            console.log(keytask_html)
            
            document.getElementById("keytask").innerHTML += keytask_html

        })
        .catch(error => {
            console.log(error.message)
        })

        

        }

        
        /* Functuon to populate header*/
        function populateHeader() {
        var url = "../db/getAllRoles.php"
        
        axios.get(url).
        then(response => {
            role = response.data[2]['LJRole_Name'] 
            dept = response.data[2]['Department']
            let header_html =  
            `
            <div class='contianer-fluid' id="myHeader">
                <div class="row">

                    <div class="col-lg-9 col-md-8">
                        <img id= 'logo' src="../Icons/Component 1.png">
                    </div>

                    <div class="col-lg-3 col-md-4">
                        <button type="button" class="btn btn-light mx-2 px-4 d-lg-inline-block" id="backBtn"
                            style="border-radius: 20px">Back</button>
                        <button type="button" class="btn btn-light mx-2 px-4 d-lg-inline-block" id="submitBtn"
                            style="border-radius: 20px">Submit</button>
                    </div>

                </div>
                <img src="../Icons/Vector 1.png" alt="Nature" class="responsive">
                <p id="Header">
                    Step 2:  Select the skills & courses for your chosen role ${role} - ${dept}
                </p>
            </div>    
                
            `      
            document.getElementById("header").innerHTML += header_html

        })
        .catch(error => {
            console.log(error.message)
        })

        }
        
        /* Handle user input */

        let selected_courses = []

        window.addEventListener('DOMContentLoaded', (event) => {
            
            console.log('DOM fully loaded and parsed')

            let course_checkboxes = document.getElementsByTagName("input")

            for (let i = 0; i < course_checkboxes.length; i++){
                document.getElementById(course_checkboxes[i].id).addEventListener("change", function(){
                    if (document.getElementById(course_checkboxes[i].id).checked){
                        console.log(course_checkboxes[i].value + " is selected")
                        selected_courses.push(course_checkboxes[i].value)
                        console.log(selected_courses)
                    }
                    else{
                        console.log(course_checkboxes[i].value + " is removed")
                        for (let j = 0; j < selected_courses.length; j++){
                            if (selected_courses[j] == course_checkboxes[i].value){
                                selected_courses.splice(selected_courses.indexOf(course_checkboxes[i].value), 1)
                            }
                        }
                        console.log(selected_courses)
                    }
                    
                })
            }
            

         })
         

        
        populateSkills()
        populateRole()
        populateTask()
        populateHeader() 
        getCourseData()

   </script>




    <!-- HTML template for skill
    <div class="RoleInfo" style="margin-top:41px; padding: 0px 0px 0px 0px">
        <div class="row">
            <div class="col">
                <img src="../Icons/Skills Image.png">
            </div>
            <div class="col-lg-7" style="margin:auto">
                <div class="card-body">
                    <div class="card-text">
                        <h1 style="font-family: Inter; font-weight: 550; font-size: 25px;">User Interface Design</h1>
                        <p style="display: inline-block; font-family: Inter; font-weight: 500;">Type of Skills: &nbsp;</p><p style="display: inline-block;">Technical</p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        <p style="display: inline-block; font-family: Inter; font-weight: 500;">Competency level: &nbsp;</p><p style="display: inline-block;">Intermediate</p><br>

                        
                            <div class="form-check" style="display:inline-block; margin-top: 20px">
                                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                                <label class="form-check-label" for="flexCheckDefault">
                                User Experience Design 
                                </label>
                                <img src= "../Icons/MoreInfo.png" style="margin-left: 5px"  data-bs-toggle="modal" data-bs-target="#staticBackdrop">
                                
                                
                                <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                                    <div class="modal-dialog modal-dialog-scrollable">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                        <h5 class="modal-title" id="staticBackdropLabel">IS213: User Experience Design</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            With Learning Journey Planner, you can explore the With Learning Journey Planner, you can explore thousands of learning journeys tailored to your preference and needs. ousands of learning journeys tailored to your preferences and needs.  With Learning Journey Planner, you can explore the With Learning Journey Planner, you can explore thousands of learning journeys tailored to your
                                            preferences and needs. ousands of learning journeys tailored to your preferences and needs. 
                                            you can explore the With Learning Journey Planner, you can explore thousands of learning journeys.
                                            With Learning Journey Planner, you can explore the With Learning Journey Planner, you can explore thousands of learning journeys tailored to your preference and needs. ousands of learning journeys tailored to your preferences and needs.  With Learning Journey Planner, you can explore the With Learning Journey Planner, you can explore thousands of learning journeys tailored to your
                                            preferences and needs. ousands of learning journeys tailored to your preferences and needs. 
                                            you can explore the With Learning Journey Planner, you can explore thousands of learning journeys.
                                            With Learning Journey Planner, you can explore the With Learning Journey Planner, you can explore thousands of learning journeys tailored to your preference and needs. ousands of learning journeys tailored to your preferences and needs.  With Learning Journey Planner, you can explore the With Learning Journey Planner, you can explore thousands of learning journeys tailored to your
                                            preferences and needs. ousands of learning journeys tailored to your preferences and needs. 
                                            you can explore the With Learning Journey Planner, you can explore thousands of learning journeys.
                                        </div>
                                        <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                                        </div>
                                    </div>
                                    </div>
                                </div>
                            </div>

                            

                            <div class="form-check" style="display:inline-block; margin-top: 20px; margin-left: 50px;">
                                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                                <label class="form-check-label" for="flexCheckDefault">
                                User Experience Design 
                                </label>
                                <img src= "../Icons/MoreInfo.png" style="margin-left: 5px">
                            </div><br>

                            <div class="form-check" style="display:inline-block; margin-top: 20px">
                                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                                <label class="form-check-label" for="flexCheckDefault">
                                User Experience Design 
                                </label>
                                <img src= "../Icons/MoreInfo.png" style="margin-left: 5px">
                            </div>

                            <div class="form-check" style="display:inline-block; margin-top: 20px;  margin-left: 50px;">
                                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                                <label class="form-check-label" for="flexCheckDefault">
                                User Experience Design 
                                </label>
                                <img src= "../Icons/MoreInfo.png" style="margin-left: 5px">
                            </div><br>
                        
                            <div class="form-check" style="display:inline-block; margin-top: 20px">
                                <input class="form-check-input" type="checkbox" value="" id="flexCheckDefault">
                                <label class="form-check-label" for="flexCheckDefault">
                                User Experience Design 
                                </label>
                                <img src= "../Icons/MoreInfo.png" style="margin-left: 5px">
                            </div>


                    </div>
                </div>
            </div>
        </div>
    </div>
    -->
     
   



</body>
</html>
<!-- JavaScript Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-u1OknCvxWvY5kfmNBILK2hRnQC3Pr17a+RTT6rIHI7NnikvbZlHgTPOOmMi466C8" crossorigin="anonymous"></script>